# LOQ
Social network for travelers

Установка и настройка проекта
---------------------

### Зависимости и venv

Управление зависимостями реализовано с помощью [Poetry](https://python-poetry.org/). Установка Poetry описана в [документации](https://python-poetry.org/docs/#installation). Зависимости указаны в файле [`pyproject.toml`](pyproject.toml). При обновлении зависимостей изменяется файл [`poetry.lock`](poetry.lock) – он так же должен жить в гите.

В папке с проектом запустить:

```bash
poetry env use python3.9
poetry install
```

### Настройка PyCharm
- Настроить только что созданый venv как дефолтный интерпретатор проекта (Project -> project interpreter)
- Далее можно запускать проект через run.py


### Миграции

Перед запуском проекта необходимо применить все имеющиеся миграции с помощью команды:

`flask db upgrade`

#### Создание миграции

`flask db migrate`

При запуске команды создания (генерации) миграции по возможности необходимо указывать краткий комментарий для миграции, например:

`flask db migrate -m 'phone type added'`

В этом случае в имя файла миграции будет добавлен указанный комментарий, что в дальнейшем поможет проще разбираться во множестве файлов миграций.

*Комментарий к миграции можно указывать без подчеркиваний - Alembic добавит их в имя файла миграции самостоятельно, при этом в самой миграции комментарий останется в читабельном виде*

**Известные проблемы**:

* Alembic неверно генерирует\не генерирует вовсе создание\изменение PostgreSQL Enum Types. Для этого необходимо после создания миграции доработать ее.


Управление приложением
---------------------

### Переменные окружения

#### Конфигурация проекта
| Переменная | Дефолтное значение | Описание |
| --- | --- | --- |
| SECRET_KEY | Рандомно генерируется при запуске | Если надоело что падают сессии при рестарте, нужно просетить статическое значение |
| SQLALCHEMY_DATABASE_URI | postgresql+psycopg2://postgres@db:5432/afo|Урл для коннекта к пг |


### Документация
[Flask Documentation](https://flask-migrate.readthedocs.io/en/latest/)
